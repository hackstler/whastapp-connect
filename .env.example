# ── WhatsApp / RAG chat ───────────────────────────────────────────────────────

# URL del endpoint de chat RAG (REQUERIDO) — p.ej. http://localhost:4000/chat
INGEST_URL=http://localhost:4000/chat

# Ruta para guardar la sesión de WhatsApp (usar volumen persistente en producción)
SESSION_PATH=.wwebjs_auth

# TTL del cache LRU de deduplicación en milisegundos (default: 5 minutos)
DEDUP_TTL_MS=300000

# Número máximo de entradas en el cache LRU
DEDUP_MAX_SIZE=1000

# ── Servidor HTTP ─────────────────────────────────────────────────────────────

# Puerto del servidor HTTP
PORT=3000

# Nivel de log: debug | info | warn | error
LOG_LEVEL=info

# ── Autenticación legacy (opcional) ──────────────────────────────────────────

# API Key para proteger /qr y /logout vía cabecera X-API-Key o ?key=
# Si no se define, esos endpoints siguen protegidos con JWT.
# Genera una con: openssl rand -hex 32
# API_KEY=

# ── Autenticación JWT & Dashboard (REQUERIDO) ─────────────────────────────────

# Secret para firmar y verificar los JWT. Mínimo 16 caracteres. (REQUERIDO)
# Genera uno con: openssl rand -hex 32
JWT_SECRET=

# Nombre del usuario administrador del dashboard (default: admin)
ADMIN_USERNAME=admin

# Contraseña del usuario administrador (mínimo 8 caracteres, se hashea en memoria)
ADMIN_PASSWORD=

# ── Backend RAG — ingest ──────────────────────────────────────────────────────

# URL base de los endpoints de ingest del rag-agent-backbone.
# Los endpoints que se usarán son:
#   POST {RAG_INGEST_URL}/url   → ingestar una URL
#   POST {RAG_INGEST_URL}/file  → ingestar un fichero (multipart)
# Ejemplo: http://localhost:4000/ingest
RAG_INGEST_URL=http://localhost:4000/ingest

# Modo mock para desarrollar sin backbone RAG.
# true  -> /api/ingest/url y /api/ingest/file responden datos simulados.
# false -> se llama al backbone real.
RAG_INGEST_MOCK_ENABLED=false

# Latencia artificial (ms) para el modo mock de ingest.
RAG_INGEST_MOCK_DELAY_MS=400

# ── Autenticación contra rag-agent-backbone ───────────────────────────────────
#
# Opción A (recomendada): Bearer JWT
#   RAG_USERNAME y RAG_PASSWORD deben coincidir con ADMIN_USERNAME y ADMIN_PASSWORD
#   del rag-agent-backbone. El servicio hace login automáticamente al arrancar
#   y renueva el token en caso de 401.
#
# RAG_USERNAME=
# RAG_PASSWORD=
#
# Opción B (legacy): X-API-Key
#   Si se define RAG_API_KEY se usa X-API-Key en lugar de JWT.
#   Debe coincidir con API_KEY del rag-agent-backbone.
#
# RAG_API_KEY=
#
# Si no se define ninguna → sin auth (solo funciona con backbone en dev mode).
